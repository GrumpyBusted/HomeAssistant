###############################################################################
# Smart-Me Kamstrup Omnipower Meter
###############################################################################

rest:
  - resource: https://api.smart-me.com/DeviceBySerial?serial=9203930
    method: GET
    authentication: basic
    username: !secret smartme_username
    password: !secret smartme_password
    scan_interval: 300
    sensor:
      - name: "Smart-Me Kamstrup Omnipower Meter Name"
        unique_id: B9943DF9-CF60-44D2-B7BC-17DA24B0B643
        value_template: "{{ value_json.Name }}"
        json_attributes:
          - "Name"
          - "Serial"
      - name: "Smart-Me Kamstrup Omnipower Meter Active Usage"
        unique_id: FD9D7727-F401-4539-972D-713EC05179EA
        value_template: "{{ value_json.ActivePower }}"
        unit_of_measurement: "kW"
        device_class: "power"
        state_class: "measurement"
        json_attributes:
          - "ActivePowerUnit"
          - "ActivePower"
      - name: "Smart-Me Kamstrup Omnipower Meter Current Counter"
        unique_id: 63120B6E-7476-4755-85AD-AF24357720C0
        value_template: "{{ value_json.CounterReading | round(2) }}"
        unit_of_measurement: "kWh"
        device_class: "power"
        state_class: "measurement"
        json_attributes:
          - "CounterReadingUnit"
          - "CounterReading"
          - "CounterReadingImport"
          - "CounterReadingExport"

